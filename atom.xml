<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://qiyulong.top</id>
    <title>吃小熊的霸王龙</title>
    <updated>2020-05-30T05:32:39.393Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://qiyulong.top"/>
    <link rel="self" href="https://qiyulong.top/atom.xml"/>
    <subtitle>学而不思则罔，思而不学则殆</subtitle>
    <logo>https://qiyulong.top/images/avatar.png</logo>
    <icon>https://qiyulong.top/favicon.ico</icon>
    <rights>All rights reserved 2020, 吃小熊的霸王龙</rights>
    <entry>
        <title type="html"><![CDATA[TP3.2上传图片]]></title>
        <id>https://qiyulong.top/post/tp32-shang-chuan-tu-pian/</id>
        <link href="https://qiyulong.top/post/tp32-shang-chuan-tu-pian/">
        </link>
        <updated>2020-05-30T04:18:13.000Z</updated>
        <content type="html"><![CDATA[<h1 id="方法一生成日期文件原图缩略图">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br>
方法一：（生成日期文件+原图+缩略图）</h1>
<p>1.在入口文件index.php配置路径：</p>
<p>//定义文件上传相关目录常量<br>
define('ROOT_PATH', <strong>DIR</strong>);<br>
define('UPLOAD_PATH', '/Public/Super/imgs/');</p>
<p>====================================================<br>
2.在Model封装一个上传logo图片的方法：</p>
<p>public function upload_logo(￥file, ￥data){<br>
//在添加商品基本数据之前，先实现文件上传，得到图片地址信息<br>
if(￥file &amp;&amp; ￥file['error'] == 0){<br>
//实例化文件上传类<br>
//自定义配置数据<br>
￥config = array(<br>
'maxSize'       =&gt;  5 * 1024 * 1024, //上传的文件大小限制 (0-不做限制) byte<br>
'exts'          =&gt;  array('jpg', 'png', 'gif', 'jpeg'), //允许上传的文件后缀<br>
'rootPath'      =&gt;  ROOT_PATH . UPLOAD_PATH, //保存根路径<br>
);<br>
￥upload = new \Think\Upload(￥config);<br>
￥upload_res = ￥upload -&gt; uploadOne(￥file);<br>
// dump(￥upload_res);die;<br>
if(!￥upload_res){<br>
//上传失败，获取错误信息<br>
￥error = ￥upload -&gt; getError();<br>
//将上传类的错误信息，记录到模型类上error属性上<br>
￥this -&gt; error = ￥error;<br>
return false;<br>
}<br>
//上传成功，需要拼接文件保存路径，用于添加到数据表<br>
￥data['goods_big_img'] = UPLOAD_PATH . ￥upload_res['savepath'] . ￥upload_res['savename'];</p>
<pre><code>     //商品logo图片上传成功，生成缩略图
     // 实例化Image类
     ￥image = new \Think\Image();
     // 使用open方法打开原始图片（需要真实的文件路径）
     ￥image -&gt; open( ROOT_PATH . ￥data['goods_big_img']);
     // 使用thumb方法生成缩略图（需要传递最大宽度和最大高度限制）
     ￥image -&gt; thumb(188, 188);
     // 使用save方法保存缩略图图片（需要真实的文件路径）
     ￥thumb_img = UPLOAD_PATH . ￥upload_res['savepath'] . 'thumb_' . ￥upload_res['savename'];
     ￥image -&gt; save( ROOT_PATH . ￥thumb_img);
     //将缩略图的路径保存到￥data中，最终保存到数据表
     ￥data['goods_small_img'] = ￥thumb_img;
     //数据处理成功，返回新的￥data
     return ￥data;
  }else{
     return ￥data;
  }
</code></pre>
<p>}</p>
<p>====================================================<br>
3.在controller里面调用：<br>
public function add(){<br>
//处理两个业务逻辑 一个是页面展示 另一个是表单提交<br>
//根据请求方式判断<br>
if(IS_POST){<br>
//表单提交<br>
￥data = I('post.');<br>
//对富文本年编辑器字段，防范xss攻击<br>
￥data['introduce'] = I('post.introduce', '', 'remove_xss');</p>
<pre><code>  ￥model = D('Goods');
  //调用模型中封装的upload_logo
  //此处logo为input中name的值
  ￥data = ￥model -&gt; upload_logo(￥_FILES['logo'], ￥data);
  if(!￥data){
     //上传过程中出错
     ￥error = ￥model -&gt; getError();
     ￥this -&gt; error(￥error);
  }
  if(!￥model -&gt; create(￥data)){
     //create方法执行失败
     //通过getError方法获取错误信息
     ￥error = ￥model -&gt; getError();
     //直接报错到页面
     ￥this -&gt; error(￥error);
  }
  ￥res = ￥model -&gt; add();//使用create方法之后，这里不需要传递参数了
  if(￥res){
     //添加成功 跳转到列表页
     // ￥this -&gt; redirect('Admin/Goods/index');//直接跳转，不显示提示信息
     ￥this -&gt; success('添加成功', U('Admin/Goods/index'));
  }else{
     //添加失败 返回添加页面
     ￥this -&gt; error('添加失败');
  }
</code></pre>
<p>}else{<br>
￥this -&gt; display();<br>
}<br>
}</p>
<h1 id="本文借鉴httpsblogcsdnnetqq_39700569articledetails80359912方法二生成日期文件原图">本文借鉴：https://blog.csdn.net/qq_39700569/article/details/80359912<br>
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br>
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br>
方法二：（生成日期文件+原图）</h1>
<h1 id="1前端input-typefile-namegpic">1.前端：<br>
<input type="file" name="gpic" /></h1>
<p>2.控制器：<br>
function addlist(){ //收集数据 展示表单两个逻辑<br>
// $Supervise = new \Model\SuperviseModel();<br>
$Supervise = new \Model\SuperviseModel();</p>
<pre><code>	        if(!empty($_POST)){
	            //处理上传的图片附件
	            //dump($_FILES);
	            if($_FILES['gpic']['error']&lt;4){
	                $cfg=array(
	                    'rootPath'      =&gt;  './Public/Super/imgs/' //保存根路径
	                );
	                $arg=new \Think\Upload($cfg);
	                $z=$arg-&gt;uploadOne($_FILES['gpic']);//执行成功后会把附件名字，路径等信息返回
	                //dump($z);
	                //dump($arg-&gt;getError());
	                //数据库中存储路径名称
	                $_POST['cont_pic']=$arg-&gt;rootPath.$z['savepath'].$z['savename'];
	
	            }
	            $shuju=$Supervise-&gt;create();
	            $z=$Supervise-&gt;add($shuju);
	            if($z){
	                $this-&gt;assign('message','图片添加成功!!!');
	                $this-&gt;success('图片添加成功','',1);
	            }else{
	                $this-&gt;assign('error','图片添加失败');
	            }
	        }else{
	            $this-&gt;display();
	        }
		}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[TP3.2常识]]></title>
        <id>https://qiyulong.top/post/tp32-chang-shi/</id>
        <link href="https://qiyulong.top/post/tp32-chang-shi/">
        </link>
        <updated>2020-05-30T03:59:03.000Z</updated>
        <content type="html"><![CDATA[<p>1.入口文件<br>
作用：配置路径，定义整站的信息。调试模式的控制。<br>
位置：与public同级</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[字符串转数组，数组转字符串]]></title>
        <id>https://qiyulong.top/post/zi-fu-chuan-zhuan-shu-zu-shu-zu-zhuan-zi-fu-chuan/</id>
        <link href="https://qiyulong.top/post/zi-fu-chuan-zhuan-shu-zu-shu-zu-zhuan-zi-fu-chuan/">
        </link>
        <updated>2020-05-29T10:00:57.000Z</updated>
        <content type="html"><![CDATA[<p>句号（任何符号）相隔字符串转数组：<br>
￥pizza = &quot;1,2,3,4,&quot;;<br>
去除最后一个逗号：￥pizzas = rtrim(￥pizza,',');<br>
字符串转数组：￥array = explode(',',￥pizzas);</p>
<p>数组转字符串：￥pizzas = implode(',',￥array);</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[tp3.2foreach循环的复选框提交数据]]></title>
        <id>https://qiyulong.top/post/tp32foreach-xun-huan-de-fu-xuan-kuang-ti-jiao-shu-ju/</id>
        <link href="https://qiyulong.top/post/tp32foreach-xun-huan-de-fu-xuan-kuang-ti-jiao-shu-ju/">
        </link>
        <updated>2020-05-29T06:21:32.000Z</updated>
        <content type="html"><![CDATA[<p>name=&quot;id[{$info.id}]&quot;<br>
此处的name中以数组形式传递，里面的键必须含有（只为id[]那不是数组）。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[js-访问页面变执行js函数]]></title>
        <id>https://qiyulong.top/post/js-fang-wen-ye-mian-bian-zhi-xing-js-han-shu/</id>
        <link href="https://qiyulong.top/post/js-fang-wen-ye-mian-bian-zhi-xing-js-han-shu/">
        </link>
        <updated>2020-05-28T18:29:09.000Z</updated>
        <content type="html"><![CDATA[<figure data-type="image" tabindex="1"><img src="https://qiyulong.top/post-images/1590690595338.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[tp3.2出现报错-非法数据对象！]]></title>
        <id>https://qiyulong.top/post/tp32-chu-xian-bao-cuo-fei-fa-shu-ju-dui-xiang/</id>
        <link href="https://qiyulong.top/post/tp32-chu-xian-bao-cuo-fei-fa-shu-ju-dui-xiang/">
        </link>
        <updated>2020-05-28T18:25:28.000Z</updated>
        <content type="html"><![CDATA[<p>原因：与create有关。</p>
<p>解决：不要create+add，而用 data[]= '';+add<br>
不要create+save，而用 data[]= '';+save</p>
<p>举例：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><msup><mo>[</mo><mo mathvariant="normal">′</mo></msup><mi>a</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mi>b</mi></msub><mi>a</mi><mi>n</mi><msup><mi>k</mi><mo mathvariant="normal">′</mo></msup><mo>]</mo><msup><mo>=</mo><mo mathvariant="normal">′</mo></msup><mi>T</mi><mi>h</mi><mi>i</mi><mi>n</mi><mi>k</mi><mi>P</mi><mi>H</mi><msup><mi>P</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">data[&#x27;account_bank&#x27;] = &#x27;ThinkPHP&#x27;;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mopen"><span class="mopen">[</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">=</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span></span></span></span>data['account'] = 'ThinkPHP@gmail.com';<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>s</mi><mi>t</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">rst =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span>Teacher-&gt;data($data)-&gt;add();</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[表格里的复选框]]></title>
        <id>https://qiyulong.top/post/biao-ge-li-de-fu-xuan-kuang/</id>
        <link href="https://qiyulong.top/post/biao-ge-li-de-fu-xuan-kuang/">
        </link>
        <updated>2020-05-27T17:15:06.000Z</updated>
        <content type="html"><![CDATA[<p>在每个表格隐藏一个input，之后便和普通的input一致。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ThinkPHP 3.2.3 增加 VIEW目录 变量替换]]></title>
        <id>https://qiyulong.top/post/thinkphp-323-zeng-jia-view-mu-lu-bian-liang-ti-huan/</id>
        <link href="https://qiyulong.top/post/thinkphp-323-zeng-jia-view-mu-lu-bian-liang-ti-huan/">
        </link>
        <updated>2020-05-19T06:51:35.000Z</updated>
        <content type="html"><![CDATA[<p>修改ThinkPHP\Library\Behavior目录下ContentReplaceBehavior.class.php</p>
<p>// 系统默认的特殊变量替换<br>
<img src="https://qiyulong.top/post-images/1589871482225.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[负载均衡]]></title>
        <id>https://qiyulong.top/post/fu-zai-jun-heng/</id>
        <link href="https://qiyulong.top/post/fu-zai-jun-heng/">
        </link>
        <updated>2020-05-19T03:41:25.000Z</updated>
        <content type="html"><![CDATA[<p>一个域名可以解析出几个IP地址，例如在访问www.163.com时，抓包得到的DNS响应包中有2个IP地址：221.229.167.47和58.220.39.91，如下图所示。<br>
<img src="https://qiyulong.top/post-images/1589859843184.jpg" alt="" loading="lazy"></p>
<p>虽然DNS解析得到了多个IP，但是大多数软件只会使用第一个IP地址，<br>
原因：当我一个IP到DNS上面请求DNS域名解析的时候，DNS系统会根据你的IP地址所到达的域名对应的IP地址中路由跳数最小的那个IP地址作为访问的IP地址，具体你可以用LINUX的NSLOOKUP来查看域名所对应的IP地址，然后用PC的TRACERT的功能把所有DNS解析出来的IP地址进行跳数记录，然后在访问该域名，查看具体是哪个地址解析给你的PC。比如百度，你会发现他上面实际解析出来的不是IP地址，而是 http://www.a.shifen.com这个域名，这个域名往下面去才是IP地址，而我估计，这个域名应该是百度自建的一个域名系统，最重要的作用就是指定你的IP所访问百度这个网址会使用到哪个IP地址，而使用CNAME有个好处就是，我IP地址去做改动的时候不需要去DNS运营商上面做改动，只需要自己的服务器做改动就好，方便自己的域名与实际IP地址做对应。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[DNS服务器]]></title>
        <id>https://qiyulong.top/post/dns-fu-wu-qi/</id>
        <link href="https://qiyulong.top/post/dns-fu-wu-qi/">
        </link>
        <updated>2020-05-16T01:14:05.000Z</updated>
        <content type="html"><![CDATA[<p>什么是DNS服务器？作用？<br>
1.DNS（Domain Name Server，域名服务器）是进行域名(domain name)和与之相对应的IP地址 (IP address)转换的服务器。<br>
2.域名解析：将域名转换为ip并发送给指定服务器。</p>
<p>PC端访问一个网址的过程：<br>
PC-&gt;DNS服务器（高速缓存访问记录，期限两天）-&gt;跟服务器（根据域【区-.com/.cn】返回对应的.com服务器IP地址）-&gt;DNS服务器（接收IP地址并访问）-&gt;.com/.cn服务器（查找访问的内容）-&gt;DNS服务器-&gt;PC端（呈现页面）<br>
<img src="https://qiyulong.top/post-images/1589592291834.png" alt="" loading="lazy"><br>
（8.8.8.8为谷歌架设的DNS服务器）</p>
<p>备注：<br>
高速缓存：期限两天，可手动删除。<br>
跟服务器：全球分为13组共计150多台，中国三四台，用于查询域服务器（.com或.cn等）对应的IP地址。</p>
]]></content>
    </entry>
</feed>